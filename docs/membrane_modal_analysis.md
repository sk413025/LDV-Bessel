# 圓形振膜模態分析

## 1.0 麥克風振膜的實際情境
在許多聲音偵測裝置（例如麥克風、聲納）中，振膜往往是探測聲波的關鍵元件。
振膜材質通常相當薄，且以一定張力被固定於圓周。不同的應用和設計策略
會決定振膜的半徑 R 以及張力 T_line（或總張力 T_total）。

舉例來說：
- 在電容式麥克風中，常用金屬化薄膜並控制張力，使膜片在可聞頻率 (20 Hz ~ 20 kHz) 範圍
  產生足夠靈敏的變形；若振膜做得過緊或過大，可能失去靈敏度或偏移響應。
- 在量測型麥克風中，往往希望比較高的固有頻率，以能涵蓋廣頻範圍；
  但半徑太小又會影響收音面積。因此工程師會在 R 與 T 之間權衡。

接下來的段落將從波動方程和 Bessel 函數的角度，詳細解釋圓形振膜模態頻率的推導過程。

## 1. 理論基礎

圓形振膜（如麥克風振膜）的振動與矩形板有本質的不同： 

- 首先，圓形振膜常使用 Bessel 函數描述其徑向與周向模態分佈，因為其數學邊界條件與矩形板採用的正弦函數不同。
- 若同時考慮振膜的張力，則其自然頻率會與張力 T 以及面密度 ρs 有關，常見公式為：
   
   ωₘₙ = (λₘₙ / R) × √(T_line / ρs)
   
   其中：
   - R 為振膜半徑
   - T_line 為線張力 (N/m)
   - ρs 為面密度 (kg/m²)
   - λₘₙ 為 Bessel 函數的零點 (對應不同模態 (m,n))

### 1.1 由波動方程導出：更完整的逐步分析

下列針對圓形振膜的偏微分方程，逐條說明物理與數學的推理過程：

1) 基本波動方程  
   在不考慮彎曲剛度、僅考慮張力條件的近似下，對一張張力為 T_line (N/m)、面密度為 ρs (kg/m²) 的圓形振膜，位移 u(r,θ,t) 通常滿足：
     ∂²u/∂t² = (T_line / ρs) ∇²u  
   這表示：振膜的加速度 ∂²u/∂t² 來自「(張力/面密度) × 拉普拉斯算子(位移)」。
   其中 ∇² 為在極座標下針對 (r,θ) 的拉普拉斯運算。  
   • 物理意義：當張力越大 (T_line↑)，加速度響應越強，特徵頻率會上升；面密度越大 (ρs↑)，系統慣性變大，自然頻率降低。

2) 分離變數與 Bessel 函數  
   為了求解此 PDE，常假設 u(r,θ,t) = W(r,θ) · f(t)。空間部分 W(r,θ) 需滿足邊界 r=R 上的位移條件 (通常固定邊界)。  
   • 因為圓邊 r=R → u=0，徑向函数常用 Bessel 函數 Jₘ(·) 表示；其零點 λₘₙ 對應能容許的徑向模態形狀。  
   • 周向方向以 e^(imθ) 或 cos(mθ)/sin(mθ) 與 Bessel 函數組合。  

3) 得到特徵方程  
   空間部分帶入後，剩下時間部分 f(t) 的方程，形如簡諧振動：  
     f¨(t) + ωₘₙ² f(t) = 0  
   其中自然角頻率：  
     ωₘₙ = ( λₘₙ / R ) √( T_line / ρs )  
   哪些 λₘₙ 可用，取決於 m 與 n (周向、徑向) 的邊界條件。  

4) 分析結果  
   • R 越大 → (λₘₙ/R) 越小 → 該模態頻率降低。  
   • T_line 越大 → ωₘₙ 上升。  
   • ρs 越大 → ωₘₙ 下降。  

### 1.2 逐步解釋：對不同半徑與張力的預期結果
1) 「同樣線張力」(T_line = const)  
   若對半徑小 (R₁) 與大 (R₂) 都給相同 N/m，則大半徑者 (R₂) 之 ωₘₙ 顯著降低。  
   如果外力頻率 ω_ext 恰好在其比較低的自然頻率附近，就可能觀察到大振幅。這解釋了「程式裡半徑較大時，位移卻更大的現象」。

2) 「同樣總張力 (use_total_tension=True)」  
   若希望比較現實中「周邊固定拉力總量」相同的兩張振膜，就應計算  
    T_line = T_total / (2πR)。  
   當 R 變大時，每單位周邊長度分得的張力減少，因此 ωₘₙ 不會下降得那麼多；振膜也不會表現出那種「大 R + 大張力」的極端鬆弛。  
   這也更符合不少麥克風設計場景：同樣總力、不同半徑 → 大小振膜的振動特性更符合理想預期。

3) 預期的觀察結果 (強迫振動)  
   - 若 use_total_tension=False (=同樣線張力) 且外力頻率固定：大 R 的固有頻率更低 → 更接近外力頻率 → 位移放大。  
   - 若 use_total_tension=True (=同樣總張力)：隨 R 增大，T_line 變小到 T_total/(2πR)；整體剛度沒降得那麼明顯，故大 R 的共振頻率下降有限 → 振幅差異可能不如前者那麼誇張，但仍比小 R 稍低的頻率。  

這些數學步驟與物理預測可對應到程式碼中 `size_effect_comparison.py` 之執行結果。若觀察到「大半徑比小半徑位移大非常多」，檢查一下是否預設 T=2000 (N/m) 不變；若想符合「同樣總周邊拉力」的現實，就打開 use_total_tension。

### 1.3 舉例實驗：外力激振下的不同行為
為了讓理論與應用更具體，可以考慮以下簡化情境：

• 情境設定：
  - 有兩個振膜：半徑分別為 R₁=0.01 m 與 R₂=0.02 m。
  - 面密度 ρs 相同 (例如 0.1 kg/m²)。
  - 若不使用 use_total_tension，表示對這兩個振膜都給定相同 T_line (N/m)，假設為 2000 N/m。
  - 外力頻率定在 1000 Hz，看看哪個振膜響應大。

• 預期結果分析：
  1) 因為 R₂=0.02 m 較大，根據 ωₘₙ ∝ 1/R，可知它的自然頻率更低。
  2) 当外力頻率固定在 1000 Hz，如果這對 R₂ 來說剛好接近某模態頻率，強迫振動的幅度就會放大。
  3) 運行程式後，可能會觀測到 R₂ 的振幅顯著大於 R₁。

• 如果改為同樣總張力 (use_total_tension=True)，則對 R₂ 會自動把張力分攤到較長的圓周，T_line 會更小，
  導致它的自然頻率並沒有降得那麼多，因此 1000 Hz 不一定能使其產生像前面那樣大幅振動。

這個實驗同時展現了理論公式與程式參數設定之間的關係：只要改動 use_total_tension，就能觀測到兩種截然不同的振幅對比，
也呼應了工程上對「總張力 vs. 線張力」的差別看法。

## 2. 張力模式 (use_total_tension)
在程式中的設計，可能會使用資料結構 material['T'] 來存放張力數值。  
為了更貼近真實麥克風振膜的行為，可以有兩種解讀：
1) 直接將 material['T'] 視為「線張力」(N/m)。  
2) 將 material['T'] 視為「總張力」(N)，並依照 2πR 動態換算成 T_line。  

這可透過一個布林值 use_total_tension 來切換。若 use_total_tension=True，則：

T_line = material['T'] / (2πR)。  

此時半徑較大的振膜不會因固定線張力而產生過度鬆弛的情形，更符合某些工程應用。 

### 2.1 物理數學推理解釋
如果我們希望在「同樣總張力 (N)」的情況下比較不同 R，大多數工程案例會依照圓周長 2πR 平均攤分。  
例如，若 material['T'] = 100 N，代表整個圓邊總共拉力 100 N，那麼對半徑 R=0.01 m 的振膜，其線張力 T_line = 100 / (2π × 0.01)。  
對半徑 R=0.02 m 的振膜，其線張力則變成 100 / (2π × 0.02)。  
於是，半徑加大時，不會再使用相同 T_line，而是依照 R 遞減，符合部分現實麥克風設計。

### 2.2 程式實作對應
在 size_effect_comparison.py 裡，可以開啟 use_total_tension=True，使程式自動計算：
  T_line = material['T'] / (2πR)
取代了原先固定的 T_line = material['T']。  
這樣在比較大 R / 小 R 時，就不會出現「大 R + 大線張力」這種不合理情況，模擬結果更符合真實麥克風膜片。 

## 3. 與其他章節或檔案的銜接
在接下來的文件 docs/size_effect_analysis.md 中，亦對不同大小振膜或板子在相同/不同張力下的振動行為做進一步比較；
而在 docs/classical_vs_bessel_modal_analysis.md 裡，則對比了矩形板 (classic) 與圓形振膜 (bessel) 的特徵方程差異。
有興趣的讀者可參考這些文件，以更全面地了解整個專案中多種類型振動問題的統一架構與差異性。 